# ===========================================
# OpenAI Codex - AI Review Automático
# ===========================================
# Docs: https://github.com/openai/codex-action
# Auth: Usa OAuth credentials de ~/.codex/auth.json
# SECURITY: Este workflow não usa inputs não confiáveis

name: Codex AI Review

on:
  pull_request:
    types: [opened, synchronize, reopened]

permissions:
  contents: read
  pull-requests: write

jobs:
  codex-review:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Codex Auth
        run: |
          mkdir -p ~/.codex
          echo '${{ secrets.CODEX_AUTH_JSON }}' > ~/.codex/auth.json
          chmod 600 ~/.codex/auth.json

      - name: Codex Code Review
        uses: openai/codex-action@v1
        with:
          sandbox: read-only
          prompt: |
            Review this PR for code quality issues.
            Focus on bugs, security vulnerabilities, performance issues.
            Provide actionable suggestions in Portuguese Brazilian.
